% Function to calculate values of Christoffel symbols

function [c, C] = christoffel_symbols(q)

c = zeros(3,3,3);

c(1,1,1) = 0;
c(1,2,1) = 0.0207 - 1.2752*cos(q(2))*sin(q(2)) + 0.4429*cos(q(3))*sin(q(3)) - sin(q(2) + q(3))*(0.8859*sin(q(2))*sin(q(3)) - 0.0325*cos(q(2)) + 0.4689*sin(q(2))) + cos(q(2) + q(3))*(0.4689*cos(q(2)) - 0.0415*cos(q(2) + q(3))) - 0.0461*cos(q(2) + q(2))  - 0.0163*sin(q(3));
c(1,3,1) = 0.0207 + 0.4429*cos(q(2))*sin(q(2)) + 0.4429*cos(q(3))*sin(q(3)) - 0.8859*sin(q(2))*sin(q(3))*sin(q(2) + q(3)) + 0.0163*cos(q(2))*sin(q(2) + q(3)) + 0.4689*cos(q(2))*cos(q(2) + q(3)) - 0.0415*cos(q(2) + q(3))^2;
c(2,1,1) = c(1,2,1);
c(2,2,1) = 1.8181*cos(q(2)) + 0.1634*sin(q(2) + q(3)) - 0.0068*cos(q(2) + q(3));
c(2,3,1) = 0.1634*sin(q(2) + q(3)) - 0.0068*cos(q(2) + q(3));
c(3,1,1) = c(1,3,1);
c(3,2,1) = c(2,3,1);
c(3,3,1) = 0.1634*sin(q(2) + q(3)) - 0.0068*cos(q(2) + q(3));
c(1,1,2) = -1*c(1,2,1);
c(1,2,2) = 0;
c(1,3,2) = 0;
c(2,1,2) = c(1,2,2);
c(2,2,2) = 0;
c(2,3,2) = 0.4689*cos(q(3)) + 0.0162*sin(q(3));
c(3,1,2) = 0;
c(3,2,2) = c(2,3,2);
c(3,3,2) = 0.4689*cos(q(3)) + 0.0162*sin(q(3));
c(1,1,3) = -1*c(1,3,1);
c(1,2,3) = -1*c(1,3,2);
c(1,3,3) = 0;
c(2,1,3) = c(1,2,3);
c(2,2,3) = -1*c(2,3,2);
c(2,3,3) = 0;
c(3,1,3) = c(1,3,3);
c(3,2,3) = c(2,3,3);
c(3,3,3) = 0;

syms q1_dot q2_dot q3_dot
C = sym(zeros(3,3));
q_dot = [q1_dot;q2_dot;q3_dot];

for k = 1:3
    for j = 1:3
        for i = 1:3
            C(j,k) = sum(c(i,j,k)*q_dot(i));
        end
    end
end
C = vpa(C);
end